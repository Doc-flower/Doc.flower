<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>å‘è¡¨åšå®¢</title>
    <link rel="shortcut icon" href="../img/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="../../public/css/bootstrap-4.6.0-dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/index.css">
    <!-- include main css -->
    <link rel="stylesheet" type="text/css" href="../../public/css/slick.css"/>

    <link rel="stylesheet" type="text/css" href="../../public/css/juery.mmenu.all.css"/>
    <link rel="stylesheet" type="text/css" href="../../public/css/style.css"/>
    <link href="../../public/css/font-awesome-4.7.0/css/font-awesome.css" rel="stylesheet" type="text/css" media="all" />
    <link rel="stylesheet" type="text/css" href="../../public/css/animate.css"/>
    <!--<link rel="stylesheet" type="text/css"  href=".././css/story.css" />-->
    <link rel="stylesheet" type="text/css"  href=".././css/blog.css" />
    <link rel="stylesheet" href="../css/footer.css">


    <script src="../../public/js/jquery-1.12.4.min.js"></script>
    <script src="../../public/css/bootstrap-4.6.0-dist/js/bootstrap.min.js"></script>

    <script>
        var myEditor = null;
        window.onload = function(){
            ClassicEditor
                .create(document.querySelector("#editor"))
                .then(editor => {
                    myEditor = editor;
                })
                .catch(error => {
                    console.error(error);
                });
        }



        function check_blog() {
            var form = document.getElementById("form_join_us");
            var url = "../../../BlogsServlet";
            if (window.XMLHttpRequest)
                req = new XMLHttpRequest();
            else if (window.ActiveXObject)
                req = new ActiveXObject("Microsoft.XMLHTTP");
            if (req) {
                //é‡‡ç”¨POSTæ–¹å¼ï¼Œå¼‚æ­¥ä¼ è¾“
                req.open("post", url, true);
                req.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
                req.onreadystatechange = checkBlogComplete;
                var data = "type=add"
                    + "&name="
                    + encodeURIComponent(document.getElementById("blog_title").value)
                    + "&owner="
                    + encodeURIComponent(document.getElementById("owner").value)
                    + "&text="
                    + encodeURIComponent(myEditor.getData())
                    + "&time="
                    + encodeURIComponent(getCurrentDate());
                req.send(data);
            }
        }

        function checkBlogComplete() {
            if (req.readyState == 4 && req.status == 200) {
                reset();
            }
        }

        function reset(){

            document.getElementById("blog_title").value = "";
            myEditor.setData("");
        }

        function clear(){
            $("#blog_clear").click(function (){
                reset();
            })

        }



        function getCurrentDate() {
            var now = new Date();
            var year = now.getFullYear(); //å¾—åˆ°å¹´ä»½
            var month = now.getMonth();//å¾—åˆ°æœˆä»½
            var date = now.getDate();//å¾—åˆ°æ—¥æœŸ
            var day = now.getDay();//å¾—åˆ°å‘¨å‡ 
            var hour = now.getHours();//å¾—åˆ°å°æ—¶
            var minu = now.getMinutes();//å¾—åˆ°åˆ†é’Ÿ
            var sec = now.getSeconds();//å¾—åˆ°ç§’
            month = month + 1;
            if (month < 10) month = "0" + month;
            if (date < 10) date = "0" + date;
            if (hour < 10) hour = "0" + hour;
            if (minu < 10) minu = "0" + minu;
            if (sec < 10) sec = "0" + sec;
            var time = "";
            time = year + "-" + month + "-" + date+ " " + hour + ":" + minu + ":" + sec;
            return time;
        }


    </script>
    <script src="../../public/js/ckeditor5-build-classic/ckeditor.js"></script>
    <style>
        #write{
            border-bottom: #1b1e21 solid 5px;
        }
    </style>
</head>
<body>
<input type="hidden" id="owner" value="liuyuyang">
    <nav>
        <div class="nav_main">
    
            <img src="../../public/img/logo.png" height="30" width="30" alt="."/>
            <div class="nav_main_title">
                <ul>
                    <li> <a href="./index.html" >é¦–é¡µ</a> </li>
                    <li><a href="./HuaXiaoKe.html">èŠ±å°ç§‘</a></li>
                    <li><a href="HuahuaXiaoShi.html">èŠ±èŠ±å°å¸‚</a></li>
                    <li><a href="LvzhiXiaoShi.html">ç»¿æ¤å°å¸‚</a></li>
                    <li><a href="./HuaXiaoQuan.html" class="title_active">èŠ±å°åœˆ</a></li>
    
                </ul>
            </div>
            <div class="nav_main_user">
                <a href="Sign.html" style="display: inline-block"><img src="../img/ç”¨æˆ·.png" alt=""></a>
                <div class="nav-item dropdown float-right">
                    <a class="nav-link dropdown-toggle" href="#" id="dropdown04" data-toggle="dropdown" aria-expanded="false">ä¸ªäººä¸­å¿ƒ</a>
                    <div class="dropdown-menu" aria-labelledby="dropdown04">
                        <a class="dropdown-item" href="person.html" target="_blank">ä¸ªäººä¿¡æ¯</a>
                        <a class="dropdown-item" href="Person_Order.html" target="_blank">è®¢å•ç®¡ç†</a>
                        <a class="dropdown-item" href="#">é€€å‡ºç™»å½•</a>
                    </div>
                    <div></div>
                </div>
            </div>
        </div>
    
    </nav>
    <main class="container">

        <!--å‘è¡¨æˆåŠŸ-->
        <div class="modal fade" id="addSuccessModal" tabindex="-1" aria-labelledby="addSuccessModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addSuccessModalLabel">ğŸ˜Šå‘è¡¨æˆåŠŸ</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        åšå®¢å‘è¡¨æˆåŠŸï¼
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-success" data-dismiss="modal">ç¡®å®š</button>                        </div>
                </div>
            </div>
        </div>




        <div class="message my-3">
            <div id="write" class="centered py-1">
                <h1 class="">å‘è¡¨åšå®¢</h1>
            </div>
        </div>
        <div class="input-group my-2">
            <div class="input-group-prepend">
                <span class="input-group-text" id="inputGroup-sizing-lg">åšå®¢æ ‡é¢˜</span>
            </div>
            <input type="text" id="blog_title" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-lg">
        </div>
        <div class="centered">
            <div id="editor">
                <h1>åœ¨è¿™é‡Œç¼–è¾‘ä½ çš„åšå®¢...</h1>
            </div>
        </div>
        <button type="button" class="btn btn-primary my-3" data-toggle="modal" data-target="#addSuccessModal" onclick="check_blog()">å‘è¡¨åšå®¢</button>
    </main>


</body>
</html>